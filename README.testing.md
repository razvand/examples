# Testing Infrastructure

This is a scripted infrastructure to test examples on Unikraft Cloud.

For each example, we added a `test_config` file and a `local_test.sh` file.
The `test_config` file stores port mapping and memory information.
The `local_test.sh` file presents how a deployed example should be tested for validation (such as doing an HTTP query or connecting a specific client).
The `test_config` files have been generated using the `generate-test-config-one.sh` script.

In order to use the testing infrastructure, run the `test-all.sh` script that goes through all examples, deploys them and tests them:

```console
./test-all.sh
```

The outputput of the test is shown on the screen, and is stored into a file named `out-test-...`.

Extract the failed runs using:

```console
grep -v '^level' out-test-2024-08-23-1102 | sed '/ Deployed /,+13d' | grep -B 10 FAILED | grep 'Testing'
```

This will present an output such as:

```text
 * Testing ./mariadb ...
 * Testing ./mongodb ...
 * Testing ./minio ...
 * Testing ./redis ...
 * Testing ./traefik ...
 * Testing ./postgres ...
 * Testing ./wordpress-all-in-one ...
 * Testing ./http-perl5.38 ...
 * Testing ./wordpress ...
 * Testing ./node-express-puppeteer ...
 * Testing ./skipper ...
 * Testing ./http-elixir1.16 ...
 * Testing ./imaginary ...
 * Testing ./java17-springboot3.2.x ...
 * Testing ./ferretdb ...
```

We can now investigate failed examples individually.
